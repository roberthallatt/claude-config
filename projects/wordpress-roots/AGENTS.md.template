# AGENTS.md — {{PROJECT_NAME}}

This file provides project context for AI coding tools (OpenAI Codex, GitHub Copilot Workspace,
and similar API-based assistants). Read this file at the start of each session.

## Project Identity

- **Name**: {{PROJECT_NAME}}
- **Stack**: WordPress Roots — Bedrock (12-factor WP) + Sage theme (Blade templates)
- **Database**: {{DDEV_DB_TYPE}} {{DDEV_DB_VERSION}}
- **PHP**: {{DDEV_PHP}}+
- **Environment**: DDEV (Docker-based local dev)
- **Primary URL**: {{DDEV_PRIMARY_URL}}
- **Admin URL**: {{DDEV_PRIMARY_URL}}/wp/wp-admin/

## Directory Structure

```
{{PROJECT_SLUG}}/
├── config/                         # WordPress configuration (environment-aware)
│   ├── application.php             # Main config (no credentials here)
│   └── environments/               # Per-environment overrides
├── web/                            # Document root
│   ├── app/
│   │   ├── themes/{{PROJECT_SLUG}}/ # Sage theme
│   │   │   ├── app/                # PHP (controllers, providers, setup)
│   │   │   ├── resources/
│   │   │   │   ├── views/          # Blade templates
│   │   │   │   ├── styles/         # Sass/CSS source
│   │   │   │   └── scripts/        # JS source
│   │   │   ├── public/             # Compiled assets (do not edit directly)
│   │   │   └── bud.config.js       # Bud.js build config
│   │   ├── plugins/                # Composer-managed plugins
│   │   ├── mu-plugins/             # Must-use plugins
│   │   └── uploads/
│   └── wp/                         # WordPress core (do not modify)
├── vendor/                         # Composer dependencies
├── .ddev/
└── .github/workflows/
```

## Development Commands

```bash
# DDEV
ddev start                          # Start local environment
ddev stop                           # Stop local environment
ddev describe                       # Show URLs and connection info
ddev ssh                            # SSH into web container

# Theme assets (Bud.js)
ddev npm run dev                    # Watch and compile assets
ddev npm run build                  # Production build

# WP-CLI
ddev wp plugin list
ddev wp cache flush
ddev wp acorn optimize              # Optimize Acorn (Sage) framework

# Composer (plugin management via Composer)
ddev composer install
ddev composer require wpackagist-plugin/plugin-name

# Database
ddev export-db > backup.sql.gz
ddev import-db < backup.sql.gz
```

## Git Workflow

- **Main branch**: `{{GIT_MAIN_BRANCH}}` — production, never commit directly
- **Integration branch**: `{{GIT_INTEGRATION_BRANCH}}` — feature branches merge here
- **Feature branches**: `feature/<description>` from `{{GIT_INTEGRATION_BRANCH}}`
- **Hotfix branches**: `hotfix/<description>` from `{{GIT_MAIN_BRANCH}}`

## Coding Conventions

- PHP: PSR-12, 4-space indentation, type declarations
- Blade templates: 2-space indentation, `{{ }}` for escaped output
- JS/CSS source files are in `resources/` — never edit compiled `public/` files
- WordPress functions go in `app/setup.php` or dedicated files under `app/`
- Use WordPress hooks (`add_action`, `add_filter`) — avoid direct function calls
- Prefix all custom functions, classes, and globals with theme slug

## Security Requirements

**Never read, display, or include the contents of these files:**

| Category | Files / Patterns |
|----------|-----------------|
| Environment | `.env`, `.env.*` — `.env.example` is safe; credentials live here in Bedrock |
| Config | `config/application.php` may reference env vars — `.env` is the secret source |
| Keys & certs | `*.key`, `*.pem`, `*.p12`, `*.pfx`, `*.crt`, `*.cer` |
| Credentials | `auth.json`, `credentials.json`, `*service-account*.json` |
| Cloud auth | `.aws/credentials`, `.aws/config`, `.azure/` |
| SSH / Git | `.ssh/`, `.git-credentials`, `.netrc` |
| Secrets | `secrets.yml`, `vault.yml`, any file with `secret` or `token` in name |
| DB snapshots | `.ddev/db_snapshots/`, `.ddev/import-db/`, `*.sql.gz` |

**Hard rules:**
- Never edit `web/wp/` (WordPress core) or `vendor/`
- `web/app/uploads/` and `web/app/themes/*/public/` should not be committed
- In Bedrock all credentials are in `.env` — never hardcode in `config/`
- Never include secrets in code examples or responses

## Important Notes

- WordPress core is managed by Composer — do not edit `web/wp/`
- Plugins are managed by Composer via `wpackagist` — do not install via WP Admin
- Run `npm run build` before deploying to ensure compiled assets are current
- See `CLAUDE.md` for Claude Code-specific workflow skills and the memory system
