# AGENTS.md — {{PROJECT_NAME}}

This file provides project context for AI coding tools (OpenAI Codex, GitHub Copilot Workspace,
and similar API-based assistants). Read this file at the start of each session.

## Project Identity

- **Name**: {{PROJECT_NAME}}
- **Stack**: Coilpack — Laravel application layer on top of ExpressionEngine CMS
- **Template Group**: `{{TEMPLATE_GROUP}}`
- **Database**: {{DDEV_DB_TYPE}} {{DDEV_DB_VERSION}}
- **PHP**: {{DDEV_PHP}}+
- **Environment**: DDEV (Docker-based local dev)
- **Primary URL**: {{DDEV_PRIMARY_URL}}

## Directory Structure

```
{{PROJECT_SLUG}}/
├── app/                           # Laravel application code
│   ├── Http/Controllers/
│   ├── Models/
│   └── Providers/
├── resources/views/               # Blade / Twig templates
├── routes/                        # Laravel route definitions
├── system/
│   ├── ee/                        # EE core — do not modify
│   └── user/
│       ├── config/config.php      # EE config (contains DB creds — never read)
│       ├── templates/             # EE template groups
│       └── addons/
├── {{DDEV_DOCROOT}}/              # Document root
├── storage/                       # Laravel storage (logs, cache, sessions)
├── bootstrap/cache/               # Laravel bootstrap cache
├── .ddev/
└── .github/workflows/
```

## Development Commands

```bash
# DDEV
ddev start                          # Start local environment
ddev stop                           # Stop local environment
ddev describe                       # Show URLs and connection info
ddev ssh                            # SSH into web container

# Laravel (via Artisan)
ddev artisan make:controller Name   # Generate controller
ddev artisan make:model Name        # Generate model
ddev artisan route:list             # List routes
ddev artisan cache:clear            # Clear application cache
ddev artisan config:clear           # Clear config cache
ddev artisan migrate                # Run database migrations

# Composer
ddev composer install               # Install PHP dependencies
ddev composer require package/name  # Add a package

# Database
ddev export-db > backup.sql.gz      # Export (compressed)
ddev import-db < backup.sql.gz      # Import
```

## Git Workflow

- **Main branch**: `{{GIT_MAIN_BRANCH}}` — production, never commit directly
- **Integration branch**: `{{GIT_INTEGRATION_BRANCH}}` — feature branches merge here
- **Feature branches**: `feature/<description>` from `{{GIT_INTEGRATION_BRANCH}}`
- **Hotfix branches**: `hotfix/<description>` from `{{GIT_MAIN_BRANCH}}`

## Coding Conventions

- PHP: PSR-12, 4-space indentation, type declarations for parameters and returns
- Laravel: follow framework conventions (service providers, facades, Eloquent)
- Blade templates: 2-space indentation, `{{ }}` for escaped output, `{!! !!}` only when safe
- Twig templates: use EE tags for CMS data; Twig for application layer views
- JS: ES6+, 2-space indentation, `const` over `let`
- Use null coalescing (`??`) and nullsafe operator (`?->`)
- Early returns to reduce nesting; avoid mutating function arguments

## Security Requirements

**Never read, display, or include the contents of these files:**

| Category | Files / Patterns |
|----------|-----------------|
| Environment | `.env`, `.env.*`, `.env.php`, `ee.env` — `.env.example` is safe |
| EE config | `system/user/config/config.php` (contains DB credentials & encryption keys) |
| Keys & certs | `*.key`, `*.pem`, `*.p12`, `*.pfx`, `*.crt`, `*.cer` |
| Credentials | `auth.json`, `credentials.json`, `*service-account*.json` |
| Cloud auth | `.aws/credentials`, `.aws/config`, `.azure/` |
| SSH / Git | `.ssh/`, `.git-credentials`, `.netrc` |
| Secrets | `secrets.yml`, `vault.yml`, any file with `secret` or `token` in name |
| DB snapshots | `.ddev/db_snapshots/`, `.ddev/import-db/`, `*.sql.gz` |

**Hard rules:**
- Never edit `system/ee/` (EE core) or Laravel's `vendor/` directory
- `storage/` and `bootstrap/cache/` are generated — never commit
- Never include secrets in code examples or responses

## Important Notes

- Laravel configuration lives in `.env`; EE configuration in `system/user/config/config.php`
- Both use the same database but serve different application layers
- See `CLAUDE.md` for Claude Code-specific workflow skills and the memory system
